import { h } from 'preact';
import { MULTI_INSTANCE_WIDGETS } from '../../widget-list/widget-config.service.js';
import { Dropdown, DropdownItem } from '../../components/Dropdown.js';
import styles from './WidgetsSection.module.css';

const widgetIcons = {
    weather: (
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <g clipPath="url(#clip-location-add)">
                <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M14.6495 1.86167C14.8343 1.53148 14.4693 1.16644 14.1391 1.35128L1.31886 8.52787C1.27871 8.55034 1.26831 8.5709 1.26366 8.58295C1.25682 8.60069 1.25339 8.62864 1.26196 8.66147C1.27052 8.69429 1.28716 8.71701 1.30179 8.72914C1.31174 8.73739 1.33086 8.75024 1.37686 8.75024H4.92559C6.20965 8.75024 7.25059 9.79118 7.25059 11.0752V14.624C7.25059 14.67 7.26344 14.6891 7.27169 14.699C7.28382 14.7137 7.30654 14.7303 7.33936 14.7389C7.37219 14.7474 7.40014 14.744 7.41787 14.7372C7.42993 14.7325 7.45048 14.7221 7.47296 14.682L14.6495 1.86167ZM13.5285 0.26055C14.9594 -0.540427 16.5412 1.04136 15.7402 2.47224L8.56369 15.2925C7.87496 16.5229 6.00059 16.034 6.00059 14.624V11.0752C6.00059 10.4815 5.51929 10.0002 4.92559 10.0002H1.37686C-0.0331622 10.0002 -0.522076 8.12588 0.708282 7.43714L13.5285 0.26055Z"
                    fill="currentColor"
                />
            </g>
            <defs>
                <clipPath id="clip-location-add">
                    <rect width="16" height="16" fill="white" />
                </clipPath>
            </defs>
        </svg>
    ),
    news: (
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path
                d="M8.375 10.75C8.72018 10.75 9 11.0298 9 11.375C9 11.7202 8.72018 12 8.375 12H3.625C3.27982 12 3 11.7202 3 11.375C3 11.0298 3.27982 10.75 3.625 10.75H8.375Z"
                fill="currentColor"
            />
            <path
                d="M8.375 7.75C8.72018 7.75 9 8.02982 9 8.375C9 8.72018 8.72018 9 8.375 9H3.625C3.27982 9 3 8.72018 3 8.375C3 8.02982 3.27982 7.75 3.625 7.75H8.375Z"
                fill="currentColor"
            />
            <path
                d="M5.25 4C5.66421 4 6 4.33579 6 4.75V5.25C6 5.66421 5.66421 6 5.25 6H3.75C3.33579 6 3 5.66421 3 5.25V4.75C3 4.33579 3.33579 4 3.75 4H5.25Z"
                fill="currentColor"
            />
            <path
                d="M8.25 4C8.66421 4 9 4.33579 9 4.75V5.25C9 5.66421 8.66421 6 8.25 6H7.75C7.33579 6 7 5.66421 7 5.25V4.75C7 4.33579 7.33579 4 7.75 4H8.25Z"
                fill="currentColor"
            />
            <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M10.125 1C11.1605 1 12 1.83947 12 2.875V3H14.125C15.1605 3 16 3.83947 16 4.875V12.25C16 13.7688 14.7688 15 13.25 15H4C1.79086 15 9.66391e-08 13.2091 0 11V2.875C1.10739e-08 1.83947 0.839466 1 1.875 1H10.125ZM1.875 2.25C1.52982 2.25 1.25 2.52982 1.25 2.875V11C1.25 12.5188 2.48122 13.75 4 13.75H11.085C10.8722 13.3823 10.75 12.9554 10.75 12.5V2.875C10.75 2.52982 10.4702 2.25 10.125 2.25H1.875ZM12 12.5C12 13.1904 12.5596 13.75 13.25 13.75C14.0784 13.75 14.75 13.0784 14.75 12.25V4.875C14.75 4.52982 14.4702 4.25 14.125 4.25H12V12.5Z"
                fill="currentColor"
            />
        </svg>
    ),
    stock: (
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path
                d="M13.875 1C15.0486 1 16 1.95139 16 3.125V5.375C16 5.72018 15.7202 6 15.375 6C15.0298 6 14.75 5.72018 14.75 5.375V3.13477L10.9424 6.94238C10.729 7.15557 10.3987 7.18219 10.1562 7.02246L10.0576 6.94238L8.75 5.63477L5.19238 9.19238C5.0752 9.30944 4.91564 9.375 4.75 9.375C4.58436 9.375 4.4248 9.30944 4.30762 9.19238L3 7.88477L1.25 9.63477V11C1.25026 12.5186 2.48138 13.75 4 13.75H12C13.5186 13.75 14.7497 12.5186 14.75 11V9.375C14.75 9.02982 15.0298 8.75 15.375 8.75C15.7202 8.75 16 9.02982 16 9.375V11C15.9997 13.2089 14.209 15 12 15H4C1.79102 15 0.000263864 13.2089 0 11V9.375C0 9.20254 0.0696586 9.0457 0.182617 8.93262L2.55762 6.55762L2.65332 6.48047C2.75528 6.41243 2.87561 6.375 3 6.375C3.16576 6.375 3.32517 6.44041 3.44238 6.55762L4.75 7.86523L8.30762 4.30762L8.40332 4.23047C8.50528 4.16243 8.62561 4.125 8.75 4.125C8.91576 4.125 9.07517 4.19041 9.19238 4.30762L10.5 5.61523L13.8652 2.25H11.375C11.0298 2.25 10.75 1.97018 10.75 1.625C10.75 1.27982 11.0298 1 11.375 1H13.875Z"
                fill="currentColor"
            />
        </svg>
    ),
};

/**
 * @param {object} props
 * @param {(widgetType: typeof MULTI_INSTANCE_WIDGETS[number]) => void} props.onAdd
 */
export function AddWidgetMenu({ onAdd }) {
    const widgetLabels = {
        weather: 'Weather',
        news: 'News',
        stock: 'Stock',
    };

    const trigger = (
        <button className={styles.addButton} aria-haspopup="true" aria-label="Add widget" type="button">
            +
        </button>
    );

    return (
        <Dropdown trigger={trigger} className={styles.addWidgetContainer}>
            {MULTI_INSTANCE_WIDGETS.map((widgetType) => (
                <DropdownItem key={widgetType} onClick={() => onAdd(widgetType)} icon={widgetIcons[widgetType]}>
                    {widgetLabels[widgetType]}
                </DropdownItem>
            ))}
        </Dropdown>
    );
}
