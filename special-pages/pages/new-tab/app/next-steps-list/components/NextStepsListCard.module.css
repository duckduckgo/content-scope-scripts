.wrapper {
    width: 100%;
    margin-bottom: var(--ntp-gap);
    position: relative;
}

.bubble {
    display: flex;
    justify-content: flex-start;
    align-items: flex-start;
    position: absolute;
    top: calc(-22 * var(--px-in-rem));
    left: 0;

    svg {
        display: block;
        flex-shrink: 0;

        path {
            fill: var(--ds-color-theme-accent-primary);
        }
    }

    div {
        background-color: var(--ds-color-theme-accent-primary);
        height: calc(20 * var(--px-in-rem));
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 1px;
        margin: -0.25px -1px 0;

        h2 {
            color: var(--ds-color-theme-accent-content-primary);
            letter-spacing: 0.06px;
            font-weight: 600;
            line-height: normal;
            font-size: calc(11 * var(--px-in-rem));
        }
    }
}

.cardContainer {
    position: relative;
    min-height: calc(200 * var(--px-in-rem));
    /* Add padding at bottom to accommodate the back card peek */
    padding-bottom: calc(12 * var(--px-in-rem));
}

.card {
    background-color: var(--ds-color-theme-surface-secondary);
    border-radius: var(--border-radius-lg);
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 1px 4px 0 rgba(0, 0, 0, 0.06);
    padding: calc(28 * var(--px-in-rem)) calc(28 * var(--px-in-rem)) calc(32 * var(--px-in-rem)) calc(20 * var(--px-in-rem));
    display: flex;
    align-items: center;
    gap: calc(12 * var(--px-in-rem));
    position: relative;
    z-index: 2;
    animation: cardFadeIn 300ms ease-out;
}

[data-theme="dark"] .card {
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.24), 0 1px 4px 0 rgba(0, 0, 0, 0.18);
}

/* Increase shadow on the front card when a back card is visible */
.cardContainer:has(.backCard) > .card:not(.backCard, .dismissing, .promoting) {
    box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.12), 0 2px 6px 0 rgba(0, 0, 0, 0.08);
}

[data-theme="dark"] .cardContainer:has(.backCard) > .card:not(.backCard, .dismissing, .promoting) {
    box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.32), 0 2px 6px 0 rgba(0, 0, 0, 0.24);
}

/* Back card (peek card) - positioned behind the main card */
.card.backCard {
    position: absolute;
    top: calc(12 * var(--px-in-rem));
    left: 0;
    right: 0;
    z-index: 1;
    pointer-events: none;
    /* Slightly scaled and dimmed to emphasize it's in the background */
    transform: scale(0.97);
    opacity: 0.85;
}

[data-theme="dark"] .card.backCard {
    opacity: 0.7;
}

/* Hide card during transition before entering animation starts (prevents flicker) */
.card.hidden {
    opacity: 0;
    transform: scale(0.97) translateY(12px);
}

/* Keep the card in the layout flow during transition to prevent container height changes */
.card.offscreen {
    visibility: hidden;
}

/* Promoting animation - back card moving to front position */
.card.promoting {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    z-index: 2;
    animation: promoteToFront 300ms ease-out forwards;
    pointer-events: none;
}

[data-theme="dark"] .card.promoting {
    animation: promoteToFrontDark 300ms ease-out forwards;
}

/* Dismiss animation - card becomes absolutely positioned so new card can fade in */
/* Uses aggressive ease-in curve so card stays visible longer, masking any potential incoming card flicker */
.card.dismissing {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    z-index: 3;
    animation: dismissFadeOut 300ms cubic-bezier(0.4, 0, 1, 1) forwards;
    pointer-events: none;
}

@keyframes cardFadeIn {
    from {
        opacity: 0;
        transform: scale(0.97) translateY(12px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

/* Animation for back card promoting to front position */
/* Starts from back card position (offset down, slightly scaled in) and animates to front */
@keyframes promoteToFront {
    from {
        opacity: 0.85;
        transform: translateY(calc(12 * var(--px-in-rem))) scale(0.97);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes promoteToFrontDark {
    from {
        opacity: 0.7;
        transform: translateY(calc(12 * var(--px-in-rem))) scale(0.97);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes dismissFadeOut {
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(50px);
    }
}

.dismissBtn {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
}

.imageContainer {
    flex: 2;
    display: flex;
    align-items: center;
    justify-content: center;
    /* Reserve space for image to prevent layout shift during card transitions */
    min-height: calc(140 * var(--px-in-rem));
}

.image {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.content {
    flex: 3;
    display: flex;
    flex-direction: column;
    gap: var(--sp-2);
}

.title {
    font-size: calc(18 * var(--px-in-rem));
    font-weight: var(--title-3-em-font-weight);
    line-height: 1.3;
    color: var(--ds-color-theme-text-primary);
    margin: 0;
}

.description {
    font-size: calc(13 * var(--px-in-rem));
    line-height: 1.3;
    color: var(--ds-color-theme-text-secondary);
    margin: 0;
}

.buttonRow {
    display: flex;
    gap: var(--sp-2);
    margin-top: var(--sp-1);
}

