<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Fingerprinting Battery</title>
    <link rel="stylesheet" href="../../shared/style.css">
</head>
<body>
    <script src="../../shared/utils.js"></script>
    <p><a href="../index.html">[Fingerprinting Battery]</a></p>

    <p>This page verifies that BatteryManager properties are spoofed to prevent fingerprinting</p>

    <script>
        test('Battery properties spoofed', async () => {
            if (!navigator.getBattery) {
                return [
                    {
                        name: 'Battery API not available (skipped)',
                        result: true,
                        expected: true,
                    },
                ];
            }

            const battery = await navigator.getBattery();
            return [
                {
                    name: 'battery.charging is true',
                    result: battery.charging,
                    expected: true,
                },
                {
                    name: 'battery.chargingTime is 0',
                    result: battery.chargingTime,
                    expected: 0,
                },
                {
                    name: 'battery.dischargingTime is Infinity',
                    result: battery.dischargingTime,
                    expected: Infinity,
                },
                {
                    name: 'battery.level is 1',
                    result: battery.level,
                    expected: 1,
                },
                {
                    name: 'battery.onchargingchange is null',
                    result: battery.onchargingchange,
                    expected: null,
                },
                {
                    name: 'battery.onchargingtimechange is null',
                    result: battery.onchargingtimechange,
                    expected: null,
                },
                {
                    name: 'battery.ondischargingtimechange is null',
                    result: battery.ondischargingtimechange,
                    expected: null,
                },
                {
                    name: 'battery.onlevelchange is null',
                    result: battery.onlevelchange,
                    expected: null,
                },
            ];
        });

        renderResults();
    </script>
</body>
</html>
