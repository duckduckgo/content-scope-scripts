<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Page Context Test</title>
    <meta name="description" content="Test page for page context feature">
    <link rel="stylesheet" href="../../shared/style.css">
</head>
<body>
    <script src="../../shared/utils.js"></script>
    <p><a href="../index.html">[Page Context]</a></p>

    <h1>Page Context Test</h1>
    <p>This page verifies that the page context feature initializes and can collect page content</p>

    <article>
        <h2>Sample Article</h2>
        <p>This is a sample paragraph with <strong>bold text</strong> and <em>italic text</em>.</p>
        <p>This is another paragraph with a <a href="https://example.com">link</a>.</p>
        <ul>
            <li>List item 1</li>
            <li>List item 2</li>
        </ul>
    </article>

    <script>
        test('Page context feature active', async () => {
            const results = [];

            // Verify the page title is accessible
            results.push({
                name: 'Page title is set',
                result: document.title.length > 0,
                expected: true,
            });

            // Verify meta description is accessible
            const metaDesc = document.querySelector('meta[name="description"]');
            results.push({
                name: 'Meta description exists',
                result: metaDesc !== null,
                expected: true,
            });

            // Verify body content is present (the feature extracts from body)
            results.push({
                name: 'Body has content',
                result: document.body.textContent.trim().length > 0,
                expected: true,
            });

            // Verify MutationObserver is available (feature uses it)
            results.push({
                name: 'MutationObserver is available',
                result: typeof MutationObserver,
                expected: 'function',
            });

            // Verify headings are present (feature can extract these)
            const headings = document.querySelectorAll('h1, h2, h3');
            results.push({
                name: 'Page has headings',
                result: headings.length > 0,
                expected: true,
            });

            // Verify links are present (feature can extract these)
            const links = document.querySelectorAll('a[href]');
            results.push({
                name: 'Page has links',
                result: links.length > 0,
                expected: true,
            });

            return results;
        });

        renderResults();
    </script>
</body>
</html>
