<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Fingerprinting Screen Size</title>
    <link rel="stylesheet" href="../../shared/style.css">
</head>
<body>
    <script src="../../shared/utils.js"></script>
    <p><a href="../index.html">[Fingerprinting Screen Size]</a></p>

    <p>This page verifies that screen size fingerprinting properties are normalized</p>

    <script>
        test('Screen properties normalized', async () => {
            return [
                {
                    name: 'screen.availTop is 0',
                    result: screen.availTop,
                    expected: 0,
                },
                {
                    name: 'screen.availLeft is 0',
                    result: screen.availLeft,
                    expected: 0,
                },
                {
                    name: 'screen.colorDepth is 24',
                    result: screen.colorDepth,
                    expected: 24,
                },
                {
                    name: 'screen.pixelDepth is 24',
                    result: screen.pixelDepth,
                    expected: 24,
                },
                {
                    name: 'screen.availWidth equals screen.width',
                    result: screen.availWidth,
                    expected: screen.width,
                },
                {
                    name: 'screen.availHeight equals screen.height',
                    result: screen.availHeight,
                    expected: screen.height,
                },
            ];
        });

        test('Screen property descriptors', async () => {
            const props = ['availTop', 'availLeft', 'colorDepth', 'pixelDepth', 'availWidth', 'availHeight'];
            const results = [];
            for (const prop of props) {
                const desc = Object.getOwnPropertyDescriptor(Screen.prototype, prop);
                if (desc) {
                    results.push({
                        name: `${prop} has getter on Screen.prototype`,
                        result: typeof desc.get,
                        expected: 'function',
                    });
                    results.push({
                        name: `${prop} is configurable`,
                        result: desc.configurable,
                        expected: true,
                    });
                }
            }
            return results;
        });

        test('Window positioning properties', async () => {
            return [
                {
                    name: 'window.screenY is a number',
                    result: typeof window.screenY,
                    expected: 'number',
                },
                {
                    name: 'window.screenTop is a number',
                    result: typeof window.screenTop,
                    expected: 'number',
                },
                {
                    name: 'window.screenX is a number',
                    result: typeof window.screenX,
                    expected: 'number',
                },
                {
                    name: 'window.screenLeft is a number',
                    result: typeof window.screenLeft,
                    expected: 'number',
                },
                {
                    name: 'window.outerHeight is a number',
                    result: typeof window.outerHeight,
                    expected: 'number',
                },
                {
                    name: 'window.outerWidth is a number',
                    result: typeof window.outerWidth,
                    expected: 'number',
                },
                {
                    name: 'window.outerHeight >= window.innerHeight',
                    result: window.outerHeight >= window.innerHeight,
                    expected: true,
                },
                {
                    name: 'window.outerWidth >= window.innerWidth',
                    result: window.outerWidth >= window.innerWidth,
                    expected: true,
                },
                {
                    name: 'screenY is not negative',
                    result: window.screenY >= 0,
                    expected: true,
                },
                {
                    name: 'screenX is not negative',
                    result: window.screenX >= 0,
                    expected: true,
                },
            ];
        });

        renderResults();
    </script>
</body>
</html>
